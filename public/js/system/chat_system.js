// Generated by CoffeeScript 1.9.3

/*
	 * БЛОК ЛОГИКИ ДЛЯ ЧАТА НОВОГО ДИЗАЙНА
 */
App.Models.Chat = Backbone.Model.extend({
  socket: {},
  defaults: function() {
    var data;
    data = {
      name: '',
      avatar: 'assets/img/profiles/d.jpg',
      begin_message: 'Сообщение заглушка',
      count_new_messages: 5,
      status: 'red'
    };
    return data;
  }
});

App.Collections.Chats = Backbone.Collection.extend({
  model: App.Models.Chat
});

App.InitCollections.Chats = new App.Collections.Chats();

App.Views.Chat = Backbone.View.extend({
  tagName: 'div',
  template: _.template($('#chat_element_template').html()),
  initialize: function() {
    console.log('test');
    return this.model.bind('destroy', this.remove, this);
  },
  render: function() {
    this.$el.html(this.template(this.model.toJSON()));
    return this;
  }
});

App.Views.ChatBody = Backbone.View.extend({
  el: '#chat-users',
  socket: {},
  initialize: function() {
    console.log('Инициализируем чат');
    this.socket = App.Functions.getSocket();
    this.socket.emit('addConsultant');
    this.socket.on('addClient', (function(_this) {
      return function(data) {
        return _this.takeNewFromSocket(data);
      };
    })(this));
    return App.InitCollections.Chats.bind('add', this.addOne, this);
  },
  addOne: function() {
    return console.log('add one chat');
  }
});

App.InitViews.ChatBody = new App.Views.ChatBody();
